enum Difficulty {
  EASY
  MEDIUM
  HARD
}

model Quiz {
  id     String @id @default(uuid())
  title  String
  userId String

  questions Question[]
  responses QuizResponse[]
  createdBy User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  startAt   DateTime?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Question {
  id     String @id @default(uuid())
  title  String
  quizId String

  difficulty Difficulty @default(MEDIUM)

  correctOptionId String?         @unique
  correctOption   QuestionOption? @relation("correctOption", fields: [correctOptionId], references: [id])

  quiz      Quiz               @relation(fields: [quizId], references: [id], onDelete: Cascade)
  options   QuestionOption[]   @relation("options")
  responses QuestionResponse[]
}

model QuestionOption {
  id         String @id @default(uuid())
  title      String
  questionId String @unique

  question          Question           @relation("options", fields: [questionId], references: [id], onDelete: Cascade)
  fromCorrectOption Question?          @relation("correctOption")
  responses         QuestionResponse[]
}

model QuizResponse {
  id     String @id @default(uuid())
  userId String

  quiz      Quiz               @relation(fields: [quizId], references: [id])
  user      User               @relation(fields: [userId], references: [id])
  responses QuestionResponse[]
  quizId    String
}

model QuestionResponse {
  id               String @id @default(uuid())
  quizResponseId   String
  questionId       String
  selectedOptionId String

  quizResponse   QuizResponse   @relation(fields: [quizResponseId], references: [id])
  question       Question       @relation(fields: [questionId], references: [id])
  selectedOption QuestionOption @relation(fields: [selectedOptionId], references: [id])
}
